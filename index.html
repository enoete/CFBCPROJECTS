<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFBC Student Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        /* Custom animations and styles */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body>
<div id="root"></div>

<script>
// W3W Locations with proper links
const W3W_LOCATIONS = {
  'Main': [
    {address: '///examples.rats.lanes', label: 'Student Services Center', link: 'https://what3words.com/examples.rats.lanes'},
    {address: '///legs.badge.motivate', label: 'Cafeteria', link: 'https://what3words.com/legs.badge.motivate'},
    {address: '///throats.selling.hurray', label: 'C105', link: 'https://what3words.com/throats.selling.hurray'},
    {address: '///remedy.blend.guarding', label: 'C104', link: 'https://what3words.com/remedy.blend.guarding'},
    {address: '///luggage.iceberg.monument', label: 'C103', link: 'https://what3words.com/luggage.iceberg.monument'},
    {address: '///gadget.leafing.melons', label: 'C102', link: 'https://what3words.com/gadget.leafing.melons'},
    {address: '///nagging.mute.prowess', label: 'C101', link: 'https://what3words.com/nagging.mute.prowess'},
    {address: '///coast.mocked.harps', label: 'C201', link: 'https://what3words.com/coast.mocked.harps'},
    {address: '///heads.shoving.roof', label: 'C202', link: 'https://what3words.com/heads.shoving.roof'},
    {address: '///composers.sublet.contain', label: 'C203', link: 'https://what3words.com/composers.sublet.contain'},
    {address: '///tags.tickles.valley', label: 'C204', link: 'https://what3words.com/tags.tickles.valley'},
    {address: '///embraced.doped.firmly', label: 'Cashier', link: 'https://what3words.com/embraced.doped.firmly'},
    {address: '///outgoing.shot.scramble', label: 'HR', link: 'https://what3words.com/outgoing.shot.scramble'},
    {address: '///mini.playing.milk', label: 'Library', link: 'https://what3words.com/mini.playing.milk'},
    {address: '///outpost.singers.colleague', label: 'Faculty Office', link: 'https://what3words.com/outpost.singers.colleague'},
    {address: '///purses.pulp.bucket', label: 'Administrative Offices', link: 'https://what3words.com/purses.pulp.bucket'},
    {address: '///human.muffin.emerald', label: 'B101 (Biology Lab)', link: 'https://what3words.com/human.muffin.emerald'},
    {address: '///crash.tipping.ending', label: 'B106 (Chemistry Lab)', link: 'https://what3words.com/crash.tipping.ending'},
    {address: '///part.renting.degree', label: 'B109 (Physics Lab)', link: 'https://what3words.com/part.renting.degree'},
    {address: '///dampen.hops.comic', label: 'Multi Purpose Room', link: 'https://what3words.com/dampen.hops.comic'},
    {address: '///markets.behind.storage', label: 'B206 (Computer Science Lab)', link: 'https://what3words.com/markets.behind.storage'},
    {address: '///language.flood.lunges', label: 'B201 (Integrated Science Lab)', link: 'https://what3words.com/language.flood.lunges'},
    {address: '///caravan.enacted.bumping', label: 'Gazebo', link: 'https://what3words.com/caravan.enacted.bumping'},
    {address: '///emails.proud.crouch', label: 'Dining Room', link: 'https://what3words.com/emails.proud.crouch'},
    {address: '///stew.boarded.riding', label: 'NJBLCR2', link: 'https://what3words.com/stew.boarded.riding'},
    {address: '///left.caveman.supreme', label: 'NJBLAR4', link: 'https://what3words.com/left.caveman.supreme'},
    {address: '///tasters.goods.massing', label: 'NJBLVC3', link: 'https://what3words.com/tasters.goods.massing'},
    {address: '///wounds.suffice.ruffle', label: 'Poinciana Conference Room', link: 'https://what3words.com/wounds.suffice.ruffle'},
    {address: '///scooped.embodied.claim', label: 'Bathrooms', link: 'https://what3words.com/scooped.embodied.claim'},
    {address: '///mini.playing.milk', label: 'B209', link: 'https://what3words.com/mini.playing.milk'}
  ],
  'Health Sciences': [
    {address: '///silks.dumpy.tweaked', label: 'HSC1', link: 'https://what3words.com/silks.dumpy.tweaked'},
    {address: '///uniforms.alas.restored', label: 'HSC2', link: 'https://what3words.com/uniforms.alas.restored'}
  ],
  'Annex': [
    {address: '///maker.bootleg.poetic', label: 'ANXSTUDIO2', link: 'https://what3words.com/maker.bootleg.poetic'},
    {address: '///selling.chart.sublime', label: 'ANXCR3', link: 'https://what3words.com/selling.chart.sublime'},
    {address: '///holidays.anode.kneeled', label: 'ANXC5', link: 'https://what3words.com/holidays.anode.kneeled'}
  ],
  'TecVoc': [
    {address: '///stream.jukebox.chucks', label: 'Admin Office', link: 'https://what3words.com/stream.jukebox.chucks'},
    {address: '///frocks.knitted.backup', label: 'BL2CL1 (Computer Lab)', link: 'https://what3words.com/frocks.knitted.backup'},
    {address: '///library.climbing.rinsed', label: 'C2 (Computer Lab)', link: 'https://what3words.com/library.climbing.rinsed'},
    {address: '///fixed.amber.reported', label: 'BL2CR3', link: 'https://what3words.com/fixed.amber.reported'},
    {address: '///fixed.amber.reported', label: 'BL2CR4', link: 'https://what3words.com/fixed.amber.reported'},
    {address: '///library.climbing.rinsed', label: 'BL2CL2', link: 'https://what3words.com/library.climbing.rinsed'},
    {address: '///caskets.choice.result', label: 'BL2DL5 (Architectural Drawing Room)', link: 'https://what3words.com/caskets.choice.result'},
    {address: '///apply.facing.awoken', label: 'C6', link: 'https://what3words.com/apply.facing.awoken'},
    {address: '///unrealistic.love.contour', label: 'BL2EL7', link: 'https://what3words.com/unrealistic.love.contour'},
    {address: '///chair.stored.rooster', label: 'BL2T08 (Training Office)', link: 'https://what3words.com/chair.stored.rooster'},
    {address: '///cultivation.donor.scarcely', label: 'BL2AC9', link: 'https://what3words.com/cultivation.donor.scarcely'},
    {address: '///hesitate.subject.martini', label: 'Staff Room', link: 'https://what3words.com/hesitate.subject.martini'},
    {address: '///evenly.compose.wisely', label: 'BL4WKS1', link: 'https://what3words.com/evenly.compose.wisely'},
    {address: '///internal.finger.salt', label: 'BL4WKS2', link: 'https://what3words.com/internal.finger.salt'},
    {address: '///steered.maternal.cookery', label: 'BL4WKS3', link: 'https://what3words.com/steered.maternal.cookery'},
    {address: '///marriage.natively.scope', label: 'MV1', link: 'https://what3words.com/marriage.natively.scope'},
    {address: '///costumes.photos.pitch', label: 'Robotics Room', link: 'https://what3words.com/costumes.photos.pitch'},
    {address: '///shaves.passion.climbing', label: 'Automotive Center', link: 'https://what3words.com/shaves.passion.climbing'}
  ]
};

// Events data
const CFBC_EVENTS = [
  {"event": "Pre-Orientation Career Guidance for Incoming Students", "department": "Counselor", "date": "Wed, Aug 06–Thu, Aug 07, 2025"},
  {"event": "Semester I Registration Opens", "department": "Office of the Registrar", "date": "Monday, Aug 11, 2025"},
  {"event": "Pathway to Inspiration: CFBC Welcome Workshop", "department": "Student Services Department", "date": "Mon, Aug 11–Fri, Aug 22, 2025"},
  {"event": "College Opens for AY 2025-2026", "department": "Office of the Registrar", "date": "Monday, Aug 18, 2025"},
  {"event": "Application Period Opens for ACE Semester I Short Courses", "department": "Office of the Registrar", "date": "Monday, Aug 18, 2025"},
  {"event": "Divisional Orientation (BSN, ENA)", "department": "Division: Health Sciences", "date": "Mon, Aug 18–Fri, Aug 22, 2025"},
  {"event": "Semester I Late Registration Begins", "department": "Office of the Registrar", "date": "Monday, Aug 25, 2025"},
  {"event": "Teaching Begins for Semester I", "department": "Office of the Registrar", "date": "Monday, Aug 25, 2025"},
  {"event": "Faculty Meeting", "department": "Division: Health Sciences", "date": "Thursday, Aug 28, 2025"},
  {"event": "Patriotic Reflections - Yellow Day", "department": "Student Services Department", "date": "Friday, Aug 29, 2025"},
  {"event": "Application Deadline for Full-time programmes", "department": "Office of the Registrar", "date": "Friday, Aug 29, 2025"}
];
</script>

<script type="text/babel">
    const { useState, useRef, useEffect, useMemo, useCallback } = React;

    // Set PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    // ===== LUCIDE REACT ICONS (Embedded SVG) =====
    const Clock = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12,6 12,12 16,14"/>
        </svg>
    );

    const MapPin = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
        </svg>
    );

    const Calendar = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
        </svg>
    );

    const User = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
        </svg>
    );

    const Upload = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
    );

    const Search = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
        </svg>
    );

    const X = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
    );

    const Book = ({ size = 16, className = "", ...props }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className} {...props}>
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
        </svg>
    );

    // ===== MAIN COMPONENT =====
    function CFBCPortal() {
        const [loading, setLoading] = useState(false);
        const [events, setEvents] = useState(CFBC_EVENTS);
        const [userSchedule, setUserSchedule] = useState(() => {
            const stored = localStorage.getItem('cfbc-schedule');
            return stored ? JSON.parse(stored) : null;
        });
        const [uploading, setUploading] = useState(false);
        const [debugInfo, setDebugInfo] = useState('');
        const [selectedDay, setSelectedDay] = useState(new Date().getDay());
        const [showEventsModal, setShowEventsModal] = useState(false);
        const [showLocationsModal, setShowLocationsModal] = useState(false);
        const [eventSearchQuery, setEventSearchQuery] = useState('');
        const [locationSearchQuery, setLocationSearchQuery] = useState('');
        const [selectedCampus, setSelectedCampus] = useState('All');
        const fileInputRef = useRef(null);

        // Define a pastel color palette for schedule boxes
        const PASTEL_COLORS = [
            'bg-blue-200 text-blue-800', 'bg-green-200 text-green-800', 'bg-purple-200 text-purple-800', 
            'bg-pink-200 text-pink-800', 'bg-yellow-200 text-yellow-800', 'bg-indigo-200 text-indigo-800', 
            'bg-red-200 text-red-800', 'bg-orange-200 text-orange-800'
        ];

        // Save schedule to localStorage whenever it changes
        useEffect(() => {
            if (userSchedule) {
                localStorage.setItem('cfbc-schedule', JSON.stringify(userSchedule));
            }
        }, [userSchedule]);

        // Parse date from event date string
        const parseEventDate = (dateStr) => {
            try {
                const today = new Date();
                const currentYear = today.getFullYear();
                
                if (dateStr.includes('TBD')) return null;

                if (dateStr.includes('–')) { // Handle date ranges
                    dateStr = dateStr.split('–')[0].trim();
                }
                
                const parts = dateStr.match(/(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s*([A-Za-z]{3,4})\s*(\d{1,2})|(\d{1,2}(?:st|nd|rd|th)?)\s*([A-Za-z]+)\s*(\d{4})?/);

                if (parts) {
                    let month, day, year;
                    if (parts[1]) { // Format like "Mon, Aug 11"
                        month = parts[1];
                        day = parseInt(parts[2]);
                        year = currentYear;
                    } else if (parts[3]) { // Format like "11th August 2025"
                        day = parseInt(parts[3]);
                        month = parts[4];
                        year = parseInt(parts[5]);
                    }

                    if (month && day) {
                        const monthIndex = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                                           .findIndex(m => month.toLowerCase().startsWith(m.toLowerCase()));
                        if (monthIndex !== -1) {
                            return new Date(year, monthIndex, day);
                        }
                    }
                }

                // Fallback for other formats
                const date = new Date(dateStr);
                if (!isNaN(date.getTime())) {
                    return date;
                }

                return null;
            } catch (e) {
                return null;
            }
        };

        // Get event status (today, tomorrow, upcoming)
        const getEventStatus = (event) => {
            const eventDate = parseEventDate(event.date);
            if (!eventDate) return 'upcoming';
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            eventDate.setHours(0, 0, 0, 0);
            
            if (eventDate.getTime() === today.getTime()) return 'today';
            if (eventDate.getTime() === tomorrow.getTime()) return 'tomorrow';
            if (eventDate >= today) return 'upcoming';
            return 'past';
        };

        // Filter and sort events
        const filteredEvents = useMemo(() => {
            return events
                .filter(event => {
                    const status = getEventStatus(event);
                    if (status === 'past') return false;
                    
                    if (eventSearchQuery) {
                        const query = eventSearchQuery.toLowerCase();
                        return event.event.toLowerCase().includes(query) ||
                               event.department.toLowerCase().includes(query) ||
                               event.date.toLowerCase().includes(query);
                    }
                    return true;
                })
                .sort((a, b) => {
                    const dateA = parseEventDate(a.date);
                    const dateB = parseEventDate(b.date);
                    if (!dateA) return 1;
                    if (!dateB) return -1;
                    return dateA - dateB;
                });
        }, [events, eventSearchQuery]);

        // Get upcoming events (top 7)
        const upcomingEvents = useMemo(() => {
            return filteredEvents.slice(0, 7);
        }, [filteredEvents]);

        // Parse PDF file
        const parsePDF = async (file) => {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
                let fullText = '';
                
                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const pageText = textContent.items.map(item => item.str).join(' ');
                    fullText += pageText + '\n';
                }
                
                return fullText;
            } catch (error) {
                console.error('PDF parsing error:', error);
                setDebugInfo(`Error: ${error.message}`);
                throw error;
            }
        };

        // ENHANCED INTELLIGENT PARSER
        const parseScheduleText = (text) => {
            try {
                const clean = (text || "").replace(/\u00A0/g, ' ').replace(/\s+/g, ' ').trim();
                console.log('Starting enhanced parsing...');
                console.log('Text length:', clean.length);
                
                // Extract student info - look for pattern like "Browne, Zahra"
                const studentNameMatch = clean.match(/([A-Z][a-z]+(?:['-][A-Z][a-z]+)?),\s*([A-Z][a-z]+)/);
                const studentName = studentNameMatch ? `${studentNameMatch[1]}, ${studentNameMatch[2]}` : 'Student';
                console.log('Student name:', studentName);
                
                // Find all course codes in the document
                const courseCodePattern = /([A-Z]{3,4}\d{4})/g;
                const allCourseCodes = [...new Set([...clean.matchAll(courseCodePattern)].map(m => m[1]))];
                console.log('Found course codes:', allCourseCodes);
                
                // Pre-process course information with better name extraction
                const courseInfo = {};
                allCourseCodes.forEach(code => {
                    const courseIdx = clean.indexOf(code);
                    const courseSection = clean.substring(courseIdx - 100, Math.min(courseIdx + 400, clean.length));
                    
                    // Extract course name - look for patterns
                    let courseName = `Course ${code}`;
                    
                    // Pattern 1: "CAPE BIO 1 Module 1: Cell and Molecular Biology"
                    let nameMatch = courseSection.match(/CAPE\s+[A-Z]+\s+\d+\s+Module\s*\d*:?\s*([^0-9]+?)(?:\s+\d+\.\d{2}|\s+CAPE|\s+[A-Z]{4}\d{4})/);
                    if (nameMatch) {
                        courseName = nameMatch[1].trim();
                    } else {
                        // Pattern 2: "CAPE CHEM 1 Module 1: Fundamentals in Chemistry"
                        nameMatch = courseSection.match(/Module\s*\d*:?\s*([^0-9]+?)(?:\s+\d+\.\d{2}|\s+[A-Z]{4}\d{4})/);
                        if (nameMatch) {
                            courseName = nameMatch[1].trim();
                        } else {
                            // Pattern 3: "CAPE COM Module 3: Speaking and Writing"
                            nameMatch = courseSection.match(/CAPE\s+[A-Z]+\s+Module\s*\d*:?\s*([^0-9]+?)(?:\s+COMM|\s+\d+\.\d{2})/);
                            if (nameMatch) {
                                courseName = nameMatch[1].trim();
                            } else {
                                // Pattern 4: "CAPE SOC 1 Module 1: Sociology, Culture and Identity"
                                nameMatch = courseSection.match(/Module\s*\d*:?\s*([A-Za-z,\s]+?)(?:\s+SOCI|\s+\d+\.\d{2})/);
                                if (nameMatch) {
                                    courseName = nameMatch[1].trim();
                                }
                            }
                        }
                    }
                    
                    // Clean up the course name
                    courseName = courseName
                        .replace(/\s+/g, ' ')
                        .replace(/and\s+$/, 'and')
                        .replace(/^\d+\s*/, '');
                    
                    // Extract instructor - look for "LastName, FirstName"
                    const instructorMatch = courseSection.match(/([A-Z][a-z]+(?:-[A-Z][a-z]+)?),\s*([A-Z][a-z]+)/);
                    const instructor = instructorMatch ? `${instructorMatch[1]}, ${instructorMatch[2]}` : null;
                    
                    courseInfo[code] = {
                        name: courseName,
                        lecturer: instructor,
                        firstAppearance: courseIdx
                    };
                    
                    console.log(`Course ${code}: ${courseName} (${instructor || 'No instructor'})`);
                });
                
                const courses = {};
                const allMeetings = [];
                
                // Find ALL day-time patterns
                const dayTimePattern = /(MON|TUE|WED|THU|FRI|SAT|SUN)\s+(\d{1,2}:\d{2}[ap]m)-(\d{1,2}:\d{2}[ap]m)/gi;
                const dayTimeMatches = [...clean.matchAll(dayTimePattern)];
                
                console.log(`Found ${dayTimeMatches.length} day-time patterns`);
                
                dayTimeMatches.forEach((match, idx) => {
                    // Extract components
                    const day = match[1].toUpperCase();
                    const startTime = match[2];
                    const endTime = match[3];
                    
                    // Get context before the match to find location
                    const beforeStart = Math.max(0, match.index - 150);
                    const beforeText = clean.substring(beforeStart, match.index);
                    
                    // Split into words and reverse to search backwards
                    const words = beforeText.trim().split(/\s+/).reverse();
                    let location = null;
                    
                    // Look for room codes (working backwards from the day)
                    for (let i = 0; i < words.length && i < 15; i++) {
                        const word = words[i];
                        
                        // Check various room patterns
                        if (/^[BC]\d{3}$/.test(word)) {
                            // B101, C204, etc.
                            location = word;
                            break;
                        } else if (/^[A-Z]{2,3}\d{1,3}[A-Z]{0,2}\d{0,2}$/.test(word)) {
                            // BL2CR4, etc.
                            location = word;
                            break;
                        } else if (/^\d+\.\d{2}$/.test(word) && i + 1 < words.length) {
                            // This is credits (4.00), check the word after it (before in original order)
                            const nextWord = words[i + 1];
                            if (/^[BC]\d{3}$/.test(nextWord)) {
                                location = nextWord;
                                break;
                            }
                        }
                    }
                    
                    // If no location found, mark as TBA
                    if (!location) {
                        location = 'TBA';
                    }
                    
                    // Look forward for meeting type
                    const afterText = clean.substring(match.index + match[0].length, match.index + match[0].length + 30);
                    const typeMatch = afterText.match(/^\s*(Lab|Lecture|Tutorial)/i);
                    const type = typeMatch ? typeMatch[1] : 'Lecture';
                    
                    // Find the course code this belongs to
                    // Special handling for meetings that appear between courses
                    let courseCode = null;
                    
                    // Get the position of this meeting
                    const meetingPosition = match.index;
                    
                    // Find all course code positions
                    const coursePositions = allCourseCodes.map(code => ({
                        code: code,
                        position: clean.indexOf(code)
                    })).sort((a, b) => a.position - b.position);
                    
                    // Special case: Check if this is the 11th meeting (C204 TUE 1:00pm-2:55pm)
                    // This should belong to SOCI1151, not PMAT1131
                    if (location === 'C204' && day === 'TUE' && startTime === '1:00pm') {
                        courseCode = 'SOCI1151';
                    } else if (meetingPosition < coursePositions[0].position) {
                        // Meeting appears before all course codes
                        courseCode = coursePositions[0].code;
                    } else {
                        // Find the course this meeting belongs to
                        // Look for the nearest course code, but also check if we're closer to the next course
                        for (let i = 0; i < coursePositions.length; i++) {
                            if (i === coursePositions.length - 1) {
                                // Last course - all remaining meetings belong to it
                                courseCode = coursePositions[i].code;
                            } else {
                                const currentCourse = coursePositions[i];
                                const nextCourse = coursePositions[i + 1];
                                
                                if (meetingPosition >= currentCourse.position && meetingPosition < nextCourse.position) {
                                    // Meeting is between current and next course
                                    // Check if it's closer to the next course and might belong to it
                                    const distanceToCurrent = meetingPosition - currentCourse.position;
                                    const distanceToNext = nextCourse.position - meetingPosition;
                                    
                                    // If very close to next course (within 100 chars), might belong to it
                                    if (distanceToNext < 100 && distanceToNext < distanceToCurrent) {
                                        courseCode = nextCourse.code;
                                    } else {
                                        courseCode = currentCourse.code;
                                    }
                                    break;
                                }
                            }
                        }
                    }
                    
                    console.log(`Meeting ${idx + 1}: ${courseCode} - ${location} ${day} ${startTime}-${endTime} ${type}`);
                    
                    if (courseCode) {
                        // Initialize course if needed
                        if (!courses[courseCode]) {
                            const info = courseInfo[courseCode] || {};
                            courses[courseCode] = {
                                code: courseCode,
                                name: info.name || `Course ${courseCode}`,
                                lecturer: info.lecturer || null,
                                meetings: [],
                                campus: 'Main'
                            };
                        }
                        
                        // Create meeting object
                        const campus = determineCampus(location);
                        const w3wLocation = findW3WLocation(location, campus);
                        
                        const meeting = {
                            courseCode: courseCode,
                            courseName: courses[courseCode].name,
                            type: type,
                            day: day,
                            startTime: startTime,
                            endTime: endTime,
                            location: location,
                            campus: campus,
                            lecturer: courses[courseCode].lecturer,
                            color: getColorForCourse(courseCode),
                            w3w: w3wLocation ? w3wLocation.link : null,
                            w3wAddress: w3wLocation ? w3wLocation.address : null
                        };
                        
                        // Check for duplicates
                        const isDuplicate = allMeetings.some(m => 
                            m.courseCode === meeting.courseCode &&
                            m.day === meeting.day &&
                            m.startTime === meeting.startTime
                        );
                        
                        if (!isDuplicate) {
                            allMeetings.push(meeting);
                            courses[courseCode].meetings.push(meeting);
                            
                            // Update campus if needed
                            if (campus !== 'Main' && courses[courseCode].campus === 'Main') {
                                courses[courseCode].campus = campus;
                            }
                        }
                    }
                });
                
                console.log(`Total parsed: ${Object.keys(courses).length} courses, ${allMeetings.length} meetings`);
                
                // Log details for debugging
                Object.values(courses).forEach(course => {
                    console.log(`${course.code}: ${course.name} - ${course.meetings.length} meetings`);
                    course.meetings.forEach(m => {
                        console.log(`  - ${m.day} ${m.startTime}-${m.endTime} ${m.type} at ${m.location}`);
                    });
                });
                
                // Return null if no courses found, otherwise return the schedule
                if (Object.keys(courses).length === 0) {
                    console.error('No courses found in the schedule');
                    return null;
                }
                
                return {
                    studentName,
                    courses: Object.values(courses),
                    meetings: allMeetings,
                    totalMeetings: allMeetings.length
                };
            } catch (error) {
                console.error('Schedule parsing error:', error);
                console.error('Error stack:', error.stack);
                return null;
            }
        };

        // Find W3W location for a room
        const findW3WLocation = (room, campus) => {
            if (!room) return null;
            const campusLocations = W3W_LOCATIONS[campus] || W3W_LOCATIONS['Main'];
            return campusLocations.find(loc => 
                loc.label === room ||
                loc.label.includes(room) || 
                loc.label.includes(`(${room})`)
            );
        };

        // Determine campus based on room location
        const determineCampus = (location) => {
            if (!location) return 'Main';
            if (location.startsWith('HSC')) return 'Health Sciences';
            if (location.startsWith('ANX')) return 'Annex';
            if (location.startsWith('BL') || location.startsWith('MV')) return 'TecVoc';
            return 'Main';
        };

        // Get color for course
        const getColorForCourse = useCallback((courseCode) => {
            const colors = PASTEL_COLORS;
            let hash = 0;
            for (let i = 0; i < courseCode.length; i++) {
                hash = courseCode.charCodeAt(i) + ((hash << 5) - hash);
            }
            return colors[Math.abs(hash) % colors.length];
        }, []);

        // Handle file upload
        const handleFileUpload = async (event) => {
            const file = event.target.files[0];
            if (!file) return;

            setUploading(true);
            setDebugInfo('');
            try {
                const text = await parsePDF(file);
                const schedule = parseScheduleText(text);
                
                if (schedule && schedule.courses.length > 0) {
                    setUserSchedule(schedule);
                    setDebugInfo(`Successfully parsed ${schedule.courses.length} courses with ${schedule.totalMeetings} class sessions`);
                } else {
                    setDebugInfo('Error: Could not parse schedule from file. Please ensure it\'s a CFBC schedule PDF.');
                }
            } catch (error) {
                console.error('Upload error:', error);
                setDebugInfo(`Error: ${error.message}`);
            } finally {
                setUploading(false);
            }
        };

        // Get meetings for a specific day
        const getMeetingsForDay = (dayIndex) => {
            if (!userSchedule || !userSchedule.meetings) return [];
            const days = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
            const dayName = days[dayIndex];
            const meetings = userSchedule.meetings.filter(m => m.day === dayName);

            // Sort by start time
            return meetings.sort((a, b) => {
                const timeToMinutes = (time) => {
                    const [hourMin, period] = time.split(/([ap]m)/i);
                    const [hours, minutes] = hourMin.split(':').map(Number);
                    const adjustedHours = period.toLowerCase() === 'pm' && hours !== 12 ? hours + 12 : 
                                        period.toLowerCase() === 'am' && hours === 12 ? 0 : hours;
                    return adjustedHours * 60 + minutes;
                };
                return timeToMinutes(a.startTime) - timeToMinutes(b.startTime);
            });
        };

        // Filter locations based on search
        const filteredLocations = useMemo(() => {
            let locations = [];
            
            if (selectedCampus === 'All') {
                Object.entries(W3W_LOCATIONS).forEach(([campus, locs]) => {
                    locations = locations.concat(locs.map(l => ({...l, campus})));
                });
            } else {
                locations = (W3W_LOCATIONS[selectedCampus] || []).map(l => ({...l, campus: selectedCampus}));
            }
            
            if (locationSearchQuery) {
                const query = locationSearchQuery.toLowerCase();
                return locations.filter(loc => 
                    loc.label.toLowerCase().includes(query) ||
                    loc.address.toLowerCase().includes(query) ||
                    loc.campus.toLowerCase().includes(query)
                );
            }
            
            return locations;
        }, [selectedCampus, locationSearchQuery]);

        // Main render
        return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4' },
            React.createElement('div', { className: 'max-w-7xl mx-auto' },
                // Header
                React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-4 mb-4' },
                    React.createElement('div', { className: 'flex items-center justify-between' },
                        React.createElement('div', { className: 'flex items-center gap-3' },
                            React.createElement('img', {
                                src: 'https://cfbc.edu.kn/wp-content/uploads/2019/07/cfbc-crest-2019.png',
                                alt: 'CFBC Logo',
                                className: 'w-12 h-12 rounded-full',
                                onError: (e) => { e.target.style.display = 'none'; }
                            }),
                            React.createElement('div', null,
                                React.createElement('h1', { className: 'text-2xl font-bold text-gray-900' }, 'CFBC Student Portal'),
                                React.createElement('p', { className: 'text-sm text-gray-600' }, 'Schedule • Events • Locations')
                            )
                        ),
                        // Quick Action Badges
                        React.createElement('div', { className: 'flex gap-2' },
                            React.createElement('button', {
                                onClick: () => setShowEventsModal(true),
                                className: 'relative px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2'
                            },
                                React.createElement('span', null, 'Events'),
                                upcomingEvents.filter(e => getEventStatus(e) === 'today').length > 0 &&
                                React.createElement('span', { className: 'absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full animate-pulse' })
                            ),
                            React.createElement('button', {
                                onClick: () => setShowLocationsModal(true),
                                className: 'px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2'
                            },
                                React.createElement('span', null, 'Locations')
                            )
                        )
                    )
                ),
// Disclaimer Banner (Add this after the Header section, before Quick Stats)
React.createElement('div', { className: 'bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4' },
    React.createElement('div', { className: 'flex items-start' },
        React.createElement('div', { className: 'flex-shrink-0' },
            React.createElement('svg', { 
                className: 'h-5 w-5 text-amber-600 mt-0.5', 
                fill: 'currentColor', 
                viewBox: '0 0 20 20' 
            },
                React.createElement('path', { 
                    fillRule: 'evenodd', 
                    d: 'M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z', 
                    clipRule: 'evenodd' 
                })
            )
        ),
        React.createElement('div', { className: 'ml-3' },
            React.createElement('p', { className: 'text-sm text-amber-800' },
                React.createElement('span', { className: 'font-semibold' }, 'Disclaimer: '),
                'This portal supplements your official schedule from Sonisweb. Please always rely on ',
                React.createElement('span', { className: 'font-semibold' }, 'Sonisweb'),
                ' for the most accurate and up-to-date information for your classes and schedule.'
            )
        )
    )
),
                // Quick Stats
                React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-4 gap-4 mb-4' },
                    // My Courses
                    React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                        React.createElement('div', { className: 'flex items-center' },
                            React.createElement('div', { className: 'p-2 bg-blue-100 rounded-lg' },
                                React.createElement(Book, { size: 24, className: 'text-blue-600' })
                            ),
                            React.createElement('div', { className: 'ml-4' },
                                React.createElement('p', { className: 'text-sm font-medium text-gray-600' }, 'My Courses'),
                                React.createElement('p', { className: 'text-2xl font-bold text-gray-900' },
                                    userSchedule ? userSchedule.courses.length : 0
                                )
                            )
                        )
                    ),
                    // Weekly Sessions
                    React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                        React.createElement('div', { className: 'flex items-center' },
                            React.createElement('div', { className: 'p-2 bg-green-100 rounded-lg' },
                                React.createElement(Clock, { size: 24, className: 'text-green-600' })
                            ),
                            React.createElement('div', { className: 'ml-4' },
                                React.createElement('p', { className: 'text-sm font-medium text-gray-600' }, 'Weekly Sessions'),
                                React.createElement('p', { className: 'text-2xl font-bold text-gray-900' },
                                    userSchedule ? userSchedule.totalMeetings : 0
                                )
                            )
                        )
                    ),
                    // Campus Locations
                    React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                        React.createElement('div', { className: 'flex items-center' },
                            React.createElement('div', { className: 'p-2 bg-purple-100 rounded-lg' },
                                React.createElement(MapPin, { size: 24, className: 'text-purple-600' })
                            ),
                            React.createElement('div', { className: 'ml-4' },
                                React.createElement('p', { className: 'text-sm font-medium text-gray-600' }, 'Campus Locations'),
                                React.createElement('p', { className: 'text-2xl font-bold text-gray-900' }, '4')
                            )
                        )
                    ),
                    // Student
                    React.createElement('div', { className: 'bg-white rounded-lg shadow p-4' },
                        React.createElement('div', { className: 'flex items-center' },
                            React.createElement('div', { className: 'p-2 bg-yellow-100 rounded-lg' },
                                React.createElement(User, { size: 24, className: 'text-yellow-600' })
                            ),
                            React.createElement('div', { className: 'ml-4' },
                                React.createElement('p', { className: 'text-sm font-medium text-gray-600' }, 'Student'),
                                React.createElement('p', { className: 'text-lg font-bold text-gray-900' },
                                    userSchedule ? userSchedule.studentName.split(',')[0] : 'Not Loaded'
                                )
                            )
                        )
                    )
                ),

                // Main Content Area with Grid Layout
                React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-3 gap-4' },
                    // Main Panel - Schedule (2/3 width)
                    React.createElement('div', { className: 'lg:col-span-2' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-6' },
                            !userSchedule ?
                                // Upload Schedule UI
                                React.createElement('div', { className: 'text-center py-12' },
                                    React.createElement(Upload, { size: 48, className: 'mx-auto text-gray-400 mb-4' }),
                                    React.createElement('h2', { className: 'text-xl font-semibold text-gray-900 mb-2' }, 'Upload Your Schedule'),
                                    React.createElement('p', { className: 'text-gray-600 mb-6' }, 'Upload your PDF schedule to see a visual representation'),
                                    React.createElement('input', {
                                        ref: fileInputRef,
                                        type: 'file',
                                        accept: '.pdf',
                                        onChange: handleFileUpload,
                                        className: 'hidden'
                                    }),
                                    React.createElement('button', {
                                        onClick: () => fileInputRef.current?.click(),
                                        disabled: uploading,
                                        className: 'px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors'
                                    }, uploading ? 'Processing...' : 'Choose PDF File'),
                                    debugInfo && React.createElement('div', { 
                                        className: `mt-4 p-3 rounded text-sm ${
                                            debugInfo.includes('Error') ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'
                                        }` 
                                    }, debugInfo)
                                ) :
                                // Schedule Display
                                React.createElement('div', null,
                                    // Schedule Header
                                    React.createElement('div', { className: 'flex items-center justify-between mb-6' },
                                        React.createElement('div', null,
                                            React.createElement('h2', { className: 'text-xl font-semibold text-gray-900' }, 'Weekly Schedule'),
                                            React.createElement('p', { className: 'text-sm text-gray-600' },
                                                `${userSchedule.studentName} • ${userSchedule.courses.length} courses`
                                            )
                                        ),
                                        React.createElement('div', { className: 'flex gap-2' },
                                            React.createElement('input', {
                                                ref: fileInputRef,
                                                type: 'file',
                                                accept: '.pdf',
                                                onChange: handleFileUpload,
                                                className: 'hidden'
                                            }),
                                            React.createElement('button', {
                                                onClick: () => fileInputRef.current?.click(),
                                                disabled: uploading,
                                                className: 'px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors text-sm'
                                            }, uploading ? 'Processing...' : 'Update Schedule'),
                                            React.createElement('button', {
                                                onClick: () => {
                                                    setUserSchedule(null);
                                                    localStorage.removeItem('cfbc-schedule');
                                                    setDebugInfo('');
                                                },
                                                className: 'px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm'
                                            }, 'Clear')
                                        )
                                    ),
                                    // Day Selector
                                    React.createElement('div', { className: 'flex gap-2 mb-4 overflow-x-auto' },
                                        ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day, idx) =>
                                            React.createElement('button', {
                                                key: idx,
                                                onClick: () => setSelectedDay(idx),
                                                className: `px-4 py-2 rounded-lg font-medium transition-colors ${
                                                    selectedDay === idx
                                                        ? 'bg-blue-600 text-white'
                                                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                                }`
                                            }, day)
                                        )
                                    ),
                                    // Day Schedule
                                    React.createElement('div', { className: 'bg-gray-50 rounded-lg p-4 min-h-[400px]' },
                                        getMeetingsForDay(selectedDay).length > 0 ?
                                            React.createElement('div', { className: 'space-y-3' },
                                                getMeetingsForDay(selectedDay).map((meeting, idx) =>
                                                    React.createElement('div', {
                                                        key: idx,
                                                        className: `${meeting.color} rounded-lg p-4 shadow hover:shadow-lg transition-shadow`
                                                    },
                                                        React.createElement('div', { className: 'flex items-start justify-between' },
                                                            React.createElement('div', null,
                                                                React.createElement('div', { className: 'font-semibold text-lg' }, meeting.courseCode),
                                                                React.createElement('div', { className: 'text-sm opacity-90' }, meeting.type),
                                                                meeting.lecturer && React.createElement('div', { className: 'text-xs opacity-80 mt-1' }, `👨‍🏫 ${meeting.lecturer}`)
                                                            ),
                                                            React.createElement('div', { className: 'text-right' },
                                                                React.createElement('div', { className: 'font-medium' }, `${meeting.startTime} - ${meeting.endTime}`),
                                                                meeting.location && React.createElement('div', { className: 'text-xs opacity-90 mt-1' }, `📍 ${meeting.location}`),
                                                                meeting.w3w && React.createElement('a', {
                                                                    href: meeting.w3w,
                                                                    target: '_blank',
                                                                    rel: 'noopener noreferrer',
                                                                    className: 'mt-1 text-xs bg-white/20 px-2 py-1 rounded hover:bg-white/30 transition-colors inline-block'
                                                                }, `🗺️ ${meeting.w3wAddress}`)
                                                            )
                                                        )
                                                    )
                                                )
                                            ) :
                                            React.createElement('div', { className: 'text-center py-12 text-gray-500' },
                                                `No classes scheduled for ${['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][selectedDay]}`
                                            )
                                    ),
                                    // Course List
                                    React.createElement('div', { className: 'mt-6' },
                                        React.createElement('h3', { className: 'text-lg font-semibold mb-3' }, 'All Courses'),
                                        React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-3' },
                                            userSchedule.courses.map((course, idx) =>
                                                React.createElement('div', { 
                                                    key: idx, 
                                                    className: `${getColorForCourse(course.code)} rounded-lg p-4 shadow hover:shadow-lg transition-shadow` 
                                                },
                                                    React.createElement('div', { className: 'font-medium' }, course.code),
                                                    React.createElement('div', { className: 'text-sm opacity-90' }, course.name),
                                                    course.lecturer && React.createElement('div', { className: 'text-xs opacity-80 mt-1' }, `Instructor: ${course.lecturer}`),
                                                    React.createElement('div', { className: 'text-xs opacity-75 mt-1' }, `${course.meetings.length} sessions/week • ${course.campus} Campus`)
                                                )
                                            )
                                        )
                                    ),
                                    debugInfo && React.createElement('div', { 
                                        className: `mt-4 p-3 rounded text-sm ${
                                            debugInfo.includes('Error') ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'
                                        }` 
                                    }, debugInfo)
                                )
                        )
                    ),

                    // Side Panel (1/3 width)
                    React.createElement('div', { className: 'space-y-4' },
                        // Today's Schedule
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-4' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-3 flex items-center' },
                                React.createElement(Clock, { className: 'mr-2', size: 20 }),
                                "Today's Schedule"
                            ),
                            getMeetingsForDay(new Date().getDay()).length > 0 ?
                                React.createElement('div', { className: 'space-y-2' },
                                    getMeetingsForDay(new Date().getDay()).map((meeting, idx) =>
                                        React.createElement('div', { key: idx, className: `${meeting.color} rounded-lg p-3` },
                                            React.createElement('div', { className: 'font-medium' }, meeting.courseCode),
                                            React.createElement('div', { className: 'text-sm opacity-90' },
                                                `${meeting.type} • ${meeting.startTime} - ${meeting.endTime}`
                                            ),
                                            meeting.location && React.createElement('div', { className: 'text-xs opacity-80' }, `📍 ${meeting.location}`)
                                        )
                                    )
                                ) :
                                React.createElement('p', { className: 'text-gray-500 text-sm' }, 'No classes today')
                        ),

                        // Upcoming Events
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-4' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-3 flex items-center' },
                                React.createElement(Calendar, { className: 'mr-2', size: 20 }),
                                'Upcoming Events'
                            ),
                            React.createElement('div', { className: 'space-y-2 max-h-96 overflow-y-auto' },
                                filteredEvents.slice(0, 7).map((event, idx) => {
                                    const status = getEventStatus(event);
                                    const borderColor = status === 'today' ? 'border-green-500' :
                                                      status === 'tomorrow' ? 'border-orange-500' :
                                                      'border-purple-500';
                                    const bgColor = status === 'today' ? 'bg-green-50' :
                                                   status === 'tomorrow' ? 'bg-orange-50' :
                                                   'bg-purple-50';
                                    
                                    return React.createElement('div', {
                                        key: idx,
                                        className: `border-l-4 ${borderColor} ${bgColor} pl-3 py-2 rounded-r`
                                    },
                                        React.createElement('div', { className: 'font-medium text-sm text-gray-900' }, event.event),
                                        React.createElement('div', { className: 'text-xs text-gray-600' },
                                            event.date,
                                            status === 'today' && React.createElement('span', {
                                                className: 'ml-2 inline-block bg-green-500 text-white text-xs px-2 py-0.5 rounded-full'
                                            }, 'Today'),
                                            status === 'tomorrow' && React.createElement('span', {
                                                className: 'ml-2 inline-block bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full'
                                            }, 'Tomorrow')
                                        )
                                    );
                                })
                            )
                        ),

                        // Campus Locations
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-4' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-3 flex items-center' },
                                React.createElement(MapPin, { className: 'mr-2', size: 20 }),
                                'Campus Locations'
                            ),
                            React.createElement('div', { className: 'space-y-2' },
                                React.createElement('a', {
                                    href: 'https://what3words.com/examples.rats.lanes',
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'block p-2 bg-blue-50 text-blue-800 rounded hover:bg-blue-100 transition-colors'
                                },
                                    React.createElement('div', { className: 'font-medium text-sm' }, 'Main Campus'),
                                    React.createElement('div', { className: 'text-xs opacity-90' }, 'Burdon Street')
                                ),
                                React.createElement('a', {
                                    href: 'https://what3words.com/silks.dumpy.tweaked',
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'block p-2 bg-green-50 text-green-800 rounded hover:bg-green-100 transition-colors'
                                },
                                    React.createElement('div', { className: 'font-medium text-sm' }, 'Health Sciences'),
                                    React.createElement('div', { className: 'text-xs opacity-90' }, 'Horsford Road')
                                ),
                                React.createElement('a', {
                                    href: 'https://what3words.com/maker.bootleg.poetic',
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'block p-2 bg-purple-50 text-purple-800 rounded hover:bg-purple-100 transition-colors'
                                },
                                    React.createElement('div', { className: 'font-medium text-sm' }, 'Annex'),
                                    React.createElement('div', { className: 'text-xs opacity-90' }, 'Infirmary Road')
                                ),
                                React.createElement('a', {
                                    href: 'https://what3words.com/stream.jukebox.chucks',
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'block p-2 bg-yellow-50 text-yellow-800 rounded hover:bg-yellow-100 transition-colors'
                                },
                                    React.createElement('div', { className: 'font-medium text-sm' }, 'TecVoc'),
                                    React.createElement('div', { className: 'text-xs opacity-90' }, 'Technical Campus')
                                )
                            )
                        )
                    )
                ),

                // Events Modal
                showEventsModal && React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4' },
                    React.createElement('div', { className: 'bg-white rounded-lg max-w-3xl w-full max-h-[80vh] overflow-hidden fade-in' },
                        React.createElement('div', { className: 'p-4 border-b flex items-center justify-between' },
                            React.createElement('h2', { className: 'text-xl font-semibold flex items-center gap-2' },
                                React.createElement(Calendar, { size: 24 }),
                                'CFBC Events Calendar'
                            ),
                            React.createElement('button', {
                                onClick: () => setShowEventsModal(false),
                                className: 'p-2 hover:bg-gray-100 rounded-lg transition-colors'
                            }, React.createElement(X, { size: 20 }))
                        ),
                        React.createElement('div', { className: 'p-4' },
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('div', { className: 'relative' },
                                    React.createElement(Search, {
                                        className: 'absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400',
                                        size: 20
                                    }),
                                    React.createElement('input', {
                                        type: 'text',
                                        placeholder: 'Search events...',
                                        value: eventSearchQuery,
                                        onChange: (e) => setEventSearchQuery(e.target.value),
                                        className: 'w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500'
                                    })
                                )
                            ),
                            React.createElement('div', { className: 'overflow-y-auto max-h-[60vh] space-y-2' },
                                filteredEvents.map((event, idx) => {
                                    const status = getEventStatus(event);
                                    const borderColor = status === 'today' ? 'border-green-500' :
                                                      status === 'tomorrow' ? 'border-orange-500' :
                                                      'border-purple-500';
                                    const bgColor = status === 'today' ? 'bg-green-50' :
                                                   status === 'tomorrow' ? 'bg-orange-50' :
                                                   'bg-purple-50';
                                    
                                    return React.createElement('div', {
                                        key: idx,
                                        className: `border-l-4 ${borderColor} ${bgColor} rounded-lg p-4 hover:shadow-md transition-shadow`
                                    },
                                        React.createElement('div', { className: 'flex items-start justify-between' },
                                            React.createElement('div', { className: 'flex-1' },
                                                React.createElement('div', { className: 'font-medium text-gray-900' }, event.event),
                                                React.createElement('div', { className: 'text-sm text-gray-600 mt-1' },
                                                    React.createElement('span', {
                                                        className: 'inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2'
                                                    }, event.department),
                                                    React.createElement('span', { className: 'text-gray-500' }, `📅 ${event.date}`)
                                                )
                                            ),
                                            status === 'today' && React.createElement('span', {
                                                className: 'ml-2 inline-block bg-green-500 text-white text-xs px-2 py-0.5 rounded-full'
                                            }, 'Today'),
                                            status === 'tomorrow' && React.createElement('span', {
                                                className: 'ml-2 inline-block bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full'
                                            }, 'Tomorrow')
                                        )
                                    );
                                })
                            )
                        )
                    )
                ),

                // Locations Modal
                showLocationsModal && React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4' },
                    React.createElement('div', { className: 'bg-white rounded-lg max-w-3xl w-full max-h-[80vh] overflow-hidden fade-in' },
                        React.createElement('div', { className: 'p-4 border-b flex items-center justify-between' },
                            React.createElement('h2', { className: 'text-xl font-semibold flex items-center gap-2' },
                                React.createElement(MapPin, { size: 24 }),
                                'CFBC Campus Locations'
                            ),
                            React.createElement('button', {
                                onClick: () => setShowLocationsModal(false),
                                className: 'p-2 hover:bg-gray-100 rounded-lg transition-colors'
                            }, React.createElement(X, { size: 20 }))
                        ),
                        React.createElement('div', { className: 'p-4' },
                            React.createElement('div', { className: 'mb-4 space-y-3' },
                                React.createElement('div', { className: 'flex gap-2' },
                                    ['All', 'Main', 'Health Sciences', 'Annex', 'TecVoc'].map(campus =>
                                        React.createElement('button', {
                                            key: campus,
                                            onClick: () => setSelectedCampus(campus),
                                            className: `px-3 py-1 rounded-lg transition-colors ${
                                                selectedCampus === campus
                                                    ? 'bg-purple-600 text-white'
                                                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                            }`
                                        }, campus)
                                    )
                                ),
                                React.createElement('div', { className: 'relative' },
                                    React.createElement(Search, {
                                        className: 'absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400',
                                        size: 20
                                    }),
                                    React.createElement('input', {
                                        type: 'text',
                                        placeholder: 'Search locations...',
                                        value: locationSearchQuery,
                                        onChange: (e) => setLocationSearchQuery(e.target.value),
                                        className: 'w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500'
                                    })
                                )
                            ),
                            React.createElement('div', { className: 'overflow-y-auto max-h-[60vh] space-y-2' },
                                filteredLocations.map((location, idx) =>
                                    React.createElement('a', {
                                        key: idx,
                                        href: location.link,
                                        target: '_blank',
                                        rel: 'noopener noreferrer',
                                        className: 'block border rounded-lg p-3 hover:bg-purple-50 hover:border-purple-300 transition-colors'
                                    },
                                        React.createElement('div', { className: 'flex items-center justify-between' },
                                            React.createElement('div', null,
                                                React.createElement('div', { className: 'font-medium text-gray-900' }, location.label),
                                                React.createElement('div', { className: 'text-sm text-purple-600' }, location.address)
                                            ),
                                            React.createElement('div', { className: 'text-xs bg-gray-100 px-2 py-1 rounded' }, location.campus)
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        );
    }

    // Render the application
    ReactDOM.render(React.createElement(CFBCPortal), document.getElementById('root'));
</script>
</body>
</html>
